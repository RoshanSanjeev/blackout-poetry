<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Blackout Poetry</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <!-- Intro Overlay -->
    <div id="overlay">
        <div class="overlay-text">
            <div>Click to Reveal the Hidden Truths</div>
            <div class="author-intro">By: Roshan Sanjeev</div>
        </div>
    </div>

    <div class="project-intro">
        <p>
            <em>About This Project:</em><br>
            In today's digital age, information is constantly filtered, censored, and manipulated. 
            This interactive blackout poetry experience symbolizes the struggle for truth against a backdrop of misinformation. 
            As you uncover each hidden word, you piece together fragments of suppressed realities â€” a small act of resistance against distortion and silence.
        </p>
    </div>

    <!-- Poem Content -->
    <div class="poem" id="poem">
        <p>In the age of <span class="censored" data-reveal="surveillance">â–ˆ</span> and <span class="censored" data-reveal="control">â–ˆ</span>,</p>
        <p><span class="censored" data-reveal="hidden">â–ˆ</span> stories die in silence.</p>
        <p><span class="censored" data-reveal="shadows">â–ˆ</span> dance across <span class="censored" data-reveal="headlines">â–ˆ</span>,</p>
        <p>Where <span class="censored" data-reveal="truth">â–ˆ</span> was meant to <span class="censored" data-reveal="shine">â–ˆ</span>.</p>

        <br>

        <p><span class="censored" data-reveal="False">â–ˆ</span> headlines <span class="censored" data-reveal="bury">â–ˆ</span> forgotten <span class="censored" data-reveal="voices">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Fear">â–ˆ</span> replaces <span class="censored" data-reveal="hope">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Doubt">â–ˆ</span> clouds every <span class="censored" data-reveal="memory">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Silence">â–ˆ</span> becomes the <span class="censored" data-reveal="law">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Control">â–ˆ</span> shapes the <span class="censored" data-reveal="future">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Voices">â–ˆ</span> silenced in <span class="censored" data-reveal="shadows">â–ˆ</span> remain unheard.</p>
        <p><span class="censored" data-reveal="Justice">â–ˆ</span> fades behind <span class="censored" data-reveal="screens">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Truth">â–ˆ</span> bends for <span class="censored" data-reveal="power">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="History">â–ˆ</span> repeats when <span class="censored" data-reveal="ignored">â–ˆ</span>.</p>
        <p><span class="censored" data-reveal="Awareness">â–ˆ</span> cracks the <span class="censored" data-reveal="cycle">â–ˆ</span>.</p>

        <!-- Call to Action Final Message (HIDDEN AT FIRST) -->
        <div class="call-to-action" id="call-to-action">
            <p><em>"Who controls the narrative controls reality.  
            Stay critical. Uncover truth."</em></p>
        </div>
    </div>

    <!-- Background Music -->
    <audio id="background-music" loop>
        <source src="{{ url_for('static', filename='audio/eerie-background.mp3') }}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Controls -->
    <div id="controls" style="display: none;">
        <span id="volume-icon">ðŸ”Š</span>
        <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0">
    </div>

    <div class="credits">
        <p>
            Project created for <strong>ENG 134: Poetry and Justice</strong><br>
            Professor David Toh Kusi â€” University of California, Merced
        </p>
    </div>

    <script>
        const overlay = document.getElementById('overlay');
        const poem = document.getElementById('poem');
        const music = document.getElementById('background-music');
        const volumeSlider = document.getElementById('volume-slider');
        const controls = document.getElementById('controls');
        const callToAction = document.getElementById('call-to-action');
        const censoredElements = document.querySelectorAll('.censored');

        // Set up defaults
        music.volume = 0;
        music.pause();
        poem.style.opacity = 0;
        controls.style.display = 'none';
        callToAction.style.opacity = 0;
        callToAction.style.visibility = 'hidden';

        overlay.addEventListener('click', () => {
            overlay.classList.add('fade-out');
            setTimeout(() => {
                overlay.style.display = 'none';
                poem.style.opacity = 1;
                controls.style.display = 'flex';
                music.play();
            }, 1000);
        });

        censoredElements.forEach(el => {
            el.addEventListener('click', () => {
                const revealText = el.getAttribute('data-reveal');
                el.textContent = revealText;
                el.classList.add('revealed');
                el.classList.add('revealed-fade');
                checkAllRevealed();
            });
        });

        function checkAllRevealed() {
            let allRevealed = true;
            censoredElements.forEach(el => {
                if (!el.classList.contains('revealed')) {
                    allRevealed = false;
                }
            });
            if (allRevealed) {
                setTimeout(() => {
                    callToAction.classList.add('show', 'flicker-once');
                }, 500);
            }
        }

        volumeSlider.addEventListener('input', () => {
            music.volume = volumeSlider.value;
        });
    </script>

</body>
</html>
